<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>GxE testing</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>*<em>Note that you can cite this work as: *</em></p>

<p><em>Jolicoeur-Martineau, A., Wazana, A., Szekely, E., Steiner, M., Fleming, A. S., Kennedy, J. L., Meaney M. J. &amp; Greenwood, C.M. (2017). Alternating optimization for GxE modelling with weighted genetic and environmental scores: examples from the MAVAN study. arXiv preprint arXiv:1703.08111.</em></p>

<p><em>Jolicoeur-Martineau, A., Belsky, J., Szekely, E., Widaman, K. F., Pluess, M., Greenwood, C., &amp; Wazana, A. (2017). Distinguishing differential susceptibility, diathesis-stress and vantage sensitivity: beyond the single gene and environment model. arXiv preprint arXiv:1712.04058.</em></p>

<h2>GxE testing</h2>

<p>From version 1.2.0 of the LEGIT package, we introduce a function to test for different types of gene-by-environment interactions (GxE) as per <a href="https://www.researchgate.net/publication/256600905_FormalGXEtestJCPP2013">Belsky et al. (2013)</a>. See our preprint: <a href="https://psyarxiv.com/27uw8">https://psyarxiv.com/27uw8</a>. We want to test if the GxE reflects diathesis stress, differential susceptibility or vantage sensitivity.</p>

<p>The figure below is a graphical representation of the different types of interactions assuming a STRONG model:</p>

<pre><code class="r">knitr::include_graphics(&quot;https://raw.githubusercontent.com/AlexiaJM/LEGIT/master/images/GxE_testing_strong.png&quot;)
</code></pre>

<p><img src="https://raw.githubusercontent.com/AlexiaJM/LEGIT/master/images/GxE_testing_strong.png" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" width="700px" /></p>

<p>The figure below is a graphical representation of the different types of interactions assuming a WEAK model:</p>

<pre><code class="r">knitr::include_graphics(&quot;https://raw.githubusercontent.com/AlexiaJM/LEGIT/master/images/GxE_testing_weak.png&quot;)
</code></pre>

<p><img src="https://raw.githubusercontent.com/AlexiaJM/LEGIT/master/images/GxE_testing_weak.png" title="plot of chunk unnamed-chunk-2" alt="plot of chunk unnamed-chunk-2" width="700px" /></p>

<p>To test for differential susceptibility, Widaman et al. (2013) estimate the cross-over point of the model. This can be done easily with LEGIT by simply adding a negative intercept to the environment E. This can be seen by the following:
\[y = 2 + 3(E-c) + 5G(E-c) \ E = q_1e_1 + q_2e_2 + &hellip; + q_le_l\]
is equivalent to
\[y = 2 + 3E' + 5GE' \ E' = -c + q_1e_1 + q_2e_2 + &hellip; + q_le_l\]</p>

<p>To test for vantage sensitivity and diathesis-stress, we can use the model above but fix the cross-over point to the expected minimum and maximum of \(E\) respectively.</p>

<h2>Simulation of diathesis-stress, vantage sensitivity and differential susceptibility</h2>

<p>Let&#39;s look at a two-way interaction model with a cross-over point and a continuous outcome:</p>

<p>\[\mathbf{g}_j \sim Binomial(n=1,p=.30) \ j = 1, 2, 3, 4\]
\[\mathbf{e}_l  \sim 10 Beta(\alpha=2,\beta=2) \ l = 1, 2, 3\]
\[\mathbf{g} = .30\mathbf{g}_1 + .10\mathbf{g}_2 + .20\mathbf{g}_3 + .40\mathbf{g}_4 \]
\[ \mathbf{e} = .45\mathbf{e}_1 + .35\mathbf{e}_2 + .20\mathbf{e}_3\]
\[\mathbf{\mu} = 3 + \beta_E(\mathbf{e}-c) + 2\mathbf{g}(\mathbf{e}-c) \] 
where \(c\) and \(\beta_E\) depend on the model assumed. \(c = 0\) represents vantage sensitivity, \(c = 10\) represents diathesis-stress. We set \(c=5\) to represents differential susceptibility. \(\beta_E = 0\) assumes a STRONG model while \(\beta_E \ne 0\) assumes a WEAK model.</p>

<p>\[ y \sim Normal(\mu,\sigma=1)\]</p>

<p>Note that the environmental score E is in the range [0,10].</p>

<h2>Example 1: Vantage sensitivity WEAK</h2>

<p>When assuming vantage sensitivity WEAK, we let \(c=0\) so that:
\[\mathbf{\mu} = 3 + (\mathbf{e}-0) + 2\mathbf{g}(\mathbf{e}-0) \] </p>

<p>We generate N=250 observations and test all 4 possible models based on the BIC (other choices are also available: AIC, AICc, cross-validation and cross-validated AUC). It is important to not include G or E in the model formula because they will be added automatically. We start by assuming that we don&#39;t know the true minimum of the environmental score, thus we use option <em>crossover = c(&ldquo;min&rdquo;,&ldquo;max&rdquo;)</em> to find the minimum/maximum from the observed data (this is the default). </p>

<pre><code class="r">set.seed(777)
library(LEGIT)
ex_dia = example_with_crossover(N=250, c=0, coef_main = c(3,1,2), sigma=1, seed=7)
GxE_test_BIC = GxE_interaction_test(data=ex_dia$data, genes=ex_dia$G, env=ex_dia$E, formula_noGxE = y ~ 1, crossover = c(&quot;min&quot;,&quot;max&quot;), criterion=&quot;BIC&quot;)
GxE_test_BIC$results
</code></pre>

<pre><code>##                                    BIC       crossover crossover 95%      
## Vantage sensitivity WEAK           &quot;772.27&quot;  &quot;0.45&quot;    &quot;&quot;                 
## Differential susceptibility WEAK   &quot;775.08&quot;  &quot;-0.4&quot;    &quot;( -0.73 / -0.07 )&quot;
## Differential susceptibility STRONG &quot;870.68&quot;  &quot;2.22&quot;    &quot;( 1.79 / 2.64 )&quot;  
## Vantage sensitivity STRONG         &quot;930.4&quot;   &quot;0.44&quot;    &quot;&quot;                 
## Diathesis-stress WEAK              &quot;971.12&quot;  &quot;9.75&quot;    &quot;&quot;                 
## Diathesis-stress STRONG            &quot;1123.61&quot; &quot;9.74&quot;    &quot;&quot;                 
## G + E only                         &quot;1237.56&quot; NA        &quot;&quot;                 
## G only                             &quot;1285.07&quot; NA        &quot;&quot;                 
## E only                             &quot;1308.15&quot; NA        &quot;&quot;                 
## Intercept only                     &quot;1341.59&quot; NA        &quot;&quot;                 
##                                    Within observable range?
## Vantage sensitivity WEAK           &quot;&quot;                      
## Differential susceptibility WEAK   &quot;No&quot;                    
## Differential susceptibility STRONG &quot;No&quot;                    
## Vantage sensitivity STRONG         &quot;&quot;                      
## Diathesis-stress WEAK              &quot;&quot;                      
## Diathesis-stress STRONG            &quot;&quot;                      
## G + E only                         &quot;&quot;                      
## G only                             &quot;&quot;                      
## E only                             &quot;&quot;                      
## Intercept only                     &quot;&quot;                      
##                                    % of observations below crossover
## Vantage sensitivity WEAK           &quot;0&quot;                              
## Differential susceptibility WEAK   &quot;0&quot;                              
## Differential susceptibility STRONG &quot;0.004&quot;                          
## Vantage sensitivity STRONG         &quot;0&quot;                              
## Diathesis-stress WEAK              &quot;1&quot;                              
## Diathesis-stress STRONG            &quot;1&quot;                              
## G + E only                         NA                               
## G only                             NA                               
## E only                             NA                               
## Intercept only                     NA
</code></pre>

<p>Here we see the results. Notice that vantage sensitivity WEAK is the model with the lowest BIC. Differential susceptibility WEAK has a slightly worse fit and the crossover point is not within observable range, thus we reject it. Note that we only show the element <em>results</em> of the output, but the 6 models (weak/strong vantage sensitivity, diathesis-stress and differential susceptibility) are also returned.</p>

<p>Considering that we know that the minimum and maximum of E are 0 and 10 respectively, we can also refit the models with <em>crossover = c(0, 10)</em>.</p>

<pre><code class="r">GxE_test_BIC_ = GxE_interaction_test(data=ex_dia$data, genes=ex_dia$G, env=ex_dia$E, formula_noGxE = y ~ 1, crossover = c(0, 10), criterion=&quot;BIC&quot;)
GxE_test_BIC_$results
</code></pre>

<pre><code>##                                    BIC       crossover crossover 95%      
## Vantage sensitivity WEAK           &quot;770.07&quot;  &quot;0&quot;       &quot;&quot;                 
## Differential susceptibility WEAK   &quot;775.08&quot;  &quot;-0.4&quot;    &quot;( -0.73 / -0.07 )&quot;
## Differential susceptibility STRONG &quot;870.68&quot;  &quot;2.22&quot;    &quot;( 1.79 / 2.64 )&quot;  
## Vantage sensitivity STRONG         &quot;948.33&quot;  &quot;0&quot;       &quot;&quot;                 
## Diathesis-stress WEAK              &quot;965.08&quot;  &quot;10&quot;      &quot;&quot;                 
## Diathesis-stress STRONG            &quot;1125.2&quot;  &quot;10&quot;      &quot;&quot;                 
## G + E only                         &quot;1237.56&quot; NA        &quot;&quot;                 
## G only                             &quot;1285.07&quot; NA        &quot;&quot;                 
## E only                             &quot;1308.15&quot; NA        &quot;&quot;                 
## Intercept only                     &quot;1341.59&quot; NA        &quot;&quot;                 
##                                    Within observable range?
## Vantage sensitivity WEAK           &quot;&quot;                      
## Differential susceptibility WEAK   &quot;No&quot;                    
## Differential susceptibility STRONG &quot;No&quot;                    
## Vantage sensitivity STRONG         &quot;&quot;                      
## Diathesis-stress WEAK              &quot;&quot;                      
## Diathesis-stress STRONG            &quot;&quot;                      
## G + E only                         &quot;&quot;                      
## G only                             &quot;&quot;                      
## E only                             &quot;&quot;                      
## Intercept only                     &quot;&quot;                      
##                                    % of observations below crossover
## Vantage sensitivity WEAK           &quot;0&quot;                              
## Differential susceptibility WEAK   &quot;0&quot;                              
## Differential susceptibility STRONG &quot;0.004&quot;                          
## Vantage sensitivity STRONG         &quot;0&quot;                              
## Diathesis-stress WEAK              &quot;1&quot;                              
## Diathesis-stress STRONG            &quot;1&quot;                              
## G + E only                         NA                               
## G only                             NA                               
## E only                             NA                               
## Intercept only                     NA
</code></pre>

<p>We obtain similar results.</p>

<p>We can then plot the best model:</p>

<pre><code class="r">plot(GxE_test_BIC$fits$vantage_sensitivity_WEAK, xlim=c(0,10), ylim=c(3,13),cex.leg=1.4, cex.axis=1.5, cex.lab=1.5)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk fig1"/></p>

<h2>Example 2: Vantage sensitivity STRONG</h2>

<p>When assuming vantage sensitivity STRONG, we let \(c=0\) and \(\beta_E=0\) so that:
\[\mathbf{\mu} = 3 + 2\mathbf{g}(\mathbf{e}-0) \] </p>

<p>We generate N=250 observations and test all 6 possible models based on the BIC assuming we don&#39;t know what is the minimum environmental score.</p>

<pre><code class="r">ex_dia_s = example_with_crossover(N=250, c=0, coef_main = c(3,0,2), sigma=1, seed=7)
GxE_test_BIC = GxE_interaction_test(data=ex_dia_s$data, genes=ex_dia_s$G, env=ex_dia_s$E, formula_noGxE = y ~ 1, crossover = c(&quot;min&quot;,&quot;max&quot;), criterion=&quot;BIC&quot;)
GxE_test_BIC$results
</code></pre>

<pre><code>##                                    BIC       crossover crossover 95%     
## Differential susceptibility STRONG &quot;770.17&quot;  &quot;-0.5&quot;    &quot;( -1.22 / 0.23 )&quot;
## Vantage sensitivity STRONG         &quot;771.77&quot;  &quot;0.45&quot;    &quot;&quot;                
## Vantage sensitivity WEAK           &quot;772.93&quot;  &quot;0.45&quot;    &quot;&quot;                
## Differential susceptibility WEAK   &quot;775.68&quot;  &quot;-0.45&quot;   &quot;( -1.18 / 0.27 )&quot;
## Diathesis-stress WEAK              &quot;967.38&quot;  &quot;9.74&quot;    &quot;&quot;                
## Diathesis-stress STRONG            &quot;1104.84&quot; &quot;9.75&quot;    &quot;&quot;                
## G + E only                         &quot;1170.07&quot; NA        &quot;&quot;                
## G only                             &quot;1171.24&quot; NA        &quot;&quot;                
## Intercept only                     &quot;1247.53&quot; NA        &quot;&quot;                
## E only                             &quot;1248.73&quot; NA        &quot;&quot;                
##                                    Within observable range?
## Differential susceptibility STRONG &quot;No&quot;                    
## Vantage sensitivity STRONG         &quot;&quot;                      
## Vantage sensitivity WEAK           &quot;&quot;                      
## Differential susceptibility WEAK   &quot;No&quot;                    
## Diathesis-stress WEAK              &quot;&quot;                      
## Diathesis-stress STRONG            &quot;&quot;                      
## G + E only                         &quot;&quot;                      
## G only                             &quot;&quot;                      
## Intercept only                     &quot;&quot;                      
## E only                             &quot;&quot;                      
##                                    % of observations below crossover
## Differential susceptibility STRONG &quot;0&quot;                              
## Vantage sensitivity STRONG         &quot;0&quot;                              
## Vantage sensitivity WEAK           &quot;0&quot;                              
## Differential susceptibility WEAK   &quot;0&quot;                              
## Diathesis-stress WEAK              &quot;1&quot;                              
## Diathesis-stress STRONG            &quot;1&quot;                              
## G + E only                         NA                               
## G only                             NA                               
## Intercept only                     NA                               
## E only                             NA
</code></pre>

<p>We conclude that vantage sensitivity STRONG is the best model.</p>

<p>We can then plot the best model:</p>

<pre><code class="r">plot(GxE_test_BIC$fits$vantage_sensitivity_STRONG, xlim=c(0,10), ylim=c(3,13),cex.leg=1.4, cex.axis=1.5, cex.lab=1.5)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk fig2"/></p>

<h2>Example 3: Differential susceptibility WEAK</h2>

<p>When assuming differential susceptibility WEAK, we let \(c=5\) (and use 8 instead of 3 as intercept to keep a similar outcome range) so that:
\[\mathbf{\mu} = 8 + (\mathbf{e}-5) + 2\mathbf{g}(\mathbf{e}-5) \] </p>

<p>We generate N=250 observations and test all 6 possible models based on the BIC assuming we don&#39;t know what is the minimum environmental score.</p>

<pre><code class="r">ex_ds = example_with_crossover(N=250, c=5, coef_main = c(3+5,1,2), sigma=1, seed=7)
GxE_test_BIC = GxE_interaction_test(data=ex_ds$data, genes=ex_ds$G, env=ex_ds$E, formula_noGxE = y ~ 1, crossover = c(&quot;min&quot;,&quot;max&quot;), criterion=&quot;BIC&quot;)
GxE_test_BIC$results
</code></pre>

<pre><code>##                                    BIC       crossover crossover 95%   
## Differential susceptibility WEAK   &quot;776.06&quot;  &quot;4.83&quot;    &quot;( 4.5 / 5.16 )&quot;
## Diathesis-stress WEAK              &quot;834.53&quot;  &quot;9.74&quot;    &quot;&quot;              
## Vantage sensitivity WEAK           &quot;835.05&quot;  &quot;0.45&quot;    &quot;&quot;              
## Differential susceptibility STRONG &quot;864.07&quot;  &quot;4.78&quot;    &quot;( 4.37 / 5.2 )&quot;
## E only                             &quot;1011.14&quot; NA        &quot;&quot;              
## G + E only                         &quot;1011.79&quot; NA        &quot;&quot;              
## Intercept only                     &quot;1149.96&quot; NA        &quot;&quot;              
## G only                             &quot;1153.2&quot;  NA        &quot;&quot;              
## Diathesis-stress STRONG            &quot;1157.61&quot; &quot;6.95&quot;    &quot;&quot;              
## Vantage sensitivity STRONG         &quot;1159.69&quot; &quot;-2.28&quot;   &quot;&quot;              
##                                    Within observable range?
## Differential susceptibility WEAK   &quot;Yes&quot;                   
## Diathesis-stress WEAK              &quot;&quot;                      
## Vantage sensitivity WEAK           &quot;&quot;                      
## Differential susceptibility STRONG &quot;Yes&quot;                   
## E only                             &quot;&quot;                      
## G + E only                         &quot;&quot;                      
## Intercept only                     &quot;&quot;                      
## G only                             &quot;&quot;                      
## Diathesis-stress STRONG            &quot;&quot;                      
## Vantage sensitivity STRONG         &quot;&quot;                      
##                                    % of observations below crossover
## Differential susceptibility WEAK   &quot;0.488&quot;                          
## Diathesis-stress WEAK              &quot;1&quot;                              
## Vantage sensitivity WEAK           &quot;0&quot;                              
## Differential susceptibility STRONG &quot;0.476&quot;                          
## E only                             NA                               
## G + E only                         NA                               
## Intercept only                     NA                               
## G only                             NA                               
## Diathesis-stress STRONG            &quot;1&quot;                              
## Vantage sensitivity STRONG         &quot;0.044&quot;
</code></pre>

<p>We conclude that differential susceptibility WEAK is the best model.</p>

<p>We can then plot the best model:</p>

<pre><code class="r">plot(GxE_test_BIC$fits$diff_suscept_WEAK, xlim=c(0,10), ylim=c(3,13),cex.leg=1.4, cex.axis=1.5, cex.lab=1.5)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk fig3"/></p>

<h2>Example 4: Differential susceptibility STRONG</h2>

<p>When assuming differential susceptibility STRONG, we let \(c=5\) and \(\beta_E=0\) (and use 8 instead of 3 as intercept to keep a similar outcome range) so that:
\[\mathbf{\mu} = 8 + 2\mathbf{g}(\mathbf{e}-5) \] </p>

<p>We generate N=250 observations and test all 6 possible models based on the BIC assuming we don&#39;t know what is the minimum environmental score.</p>

<pre><code class="r">ex_ds_s = example_with_crossover(N=250, c=5, coef_main = c(3+5,0,2), sigma=1, seed=7)
GxE_test_BIC = GxE_interaction_test(data=ex_ds_s$data, genes=ex_ds_s$G, env=ex_ds_s$E, formula_noGxE = y ~ 1, crossover = c(&quot;min&quot;,&quot;max&quot;), criterion=&quot;BIC&quot;)
GxE_test_BIC$results
</code></pre>

<pre><code>##                                    BIC      crossover crossover 95%    
## Differential susceptibility STRONG &quot;771.2&quot;  &quot;4.84&quot;    &quot;( 4.13 / 5.55 )&quot;
## Differential susceptibility WEAK   &quot;776.64&quot; &quot;4.84&quot;    &quot;( 4.12 / 5.55 )&quot;
## Diathesis-stress WEAK              &quot;834.4&quot;  &quot;9.74&quot;    &quot;&quot;               
## Vantage sensitivity WEAK           &quot;834.9&quot;  &quot;0.44&quot;    &quot;&quot;               
## E only                             &quot;848.02&quot; NA        &quot;&quot;               
## G + E only                         &quot;851.11&quot; NA        &quot;&quot;               
## Intercept only                     &quot;895.99&quot; NA        &quot;&quot;               
## G only                             &quot;899.81&quot; NA        &quot;&quot;               
## Diathesis-stress STRONG            &quot;909.24&quot; &quot;6.77&quot;    &quot;&quot;               
## Vantage sensitivity STRONG         &quot;913.1&quot;  &quot;-2.45&quot;   &quot;&quot;               
##                                    Within observable range?
## Differential susceptibility STRONG &quot;Yes&quot;                   
## Differential susceptibility WEAK   &quot;Yes&quot;                   
## Diathesis-stress WEAK              &quot;&quot;                      
## Vantage sensitivity WEAK           &quot;&quot;                      
## E only                             &quot;&quot;                      
## G + E only                         &quot;&quot;                      
## Intercept only                     &quot;&quot;                      
## G only                             &quot;&quot;                      
## Diathesis-stress STRONG            &quot;&quot;                      
## Vantage sensitivity STRONG         &quot;&quot;                      
##                                    % of observations below crossover
## Differential susceptibility STRONG &quot;0.484&quot;                          
## Differential susceptibility WEAK   &quot;0.484&quot;                          
## Diathesis-stress WEAK              &quot;1&quot;                              
## Vantage sensitivity WEAK           &quot;0&quot;                              
## E only                             NA                               
## G + E only                         NA                               
## Intercept only                     NA                               
## G only                             NA                               
## Diathesis-stress STRONG            &quot;1&quot;                              
## Vantage sensitivity STRONG         &quot;0.036&quot;
</code></pre>

<p>We conclude that differential susceptibility STRONG is the best model.</p>

<p>We can then plot the best model:</p>

<pre><code class="r">plot(GxE_test_BIC$fits$diff_suscept_STRONG, xlim=c(0,10), ylim=c(3,13),cex.leg=1.4, cex.axis=1.5, cex.lab=1.5)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk fig4"/></p>

</body>

</html>
